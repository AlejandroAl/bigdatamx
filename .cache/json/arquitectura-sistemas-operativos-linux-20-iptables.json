{
    "data": {
        "markdownRemark": {
            "html": "<h2>20. Iptables</h2>\n<p>El sistema operativo Linux dispone de un firewall llamado IPtables.</p>\n<p>Iptables es un firewall incluido en el kernel de Linux desde la versión 2.4 que está incluido en el sistema operativo. Es un firewall basado en reglas, su funcionamiento se basa en aplicar reglas que el mismo firewall ejecute. </p>\n<p>Iptables se saco un mayor provecho o tiene una mejor funciones en distribuciones linux para servidores, como lo son red hat enterprise, fedora, centos, oracle linux, etc.</p>\n<ul>\n<li>Comando para instalar iptables :</li>\n</ul>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>En una distribución red hat el comando es :\n\nyum -y install iptables</code></pre>\n      </div>\n<h3>Manejar el servicio de iptables :</h3>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>Para iniciar: \n\nsudo service iptables start\n\nPara para: \n\nsudo service iptables stop\n\nPara reiniciar:\n\nsudo service iptables restart</code></pre>\n      </div>\n<h3>Cadenas Iptables :</h3>\n<p>El objetivo de las cadenas es poder controlar el flujo de un paquete a través del sistema y la pila de red .</p>\n<p>Las cadenas principales son :</p>\n<ul>\n<li>PREROUTING: tráfico entrante, justo antes de ingresar a la pila de red del kernel. Las reglas en esta cadena son procesadas antes de tomar cualquier decisión de ruteo respecto hacia dónde enviar el paquete.</li>\n<li>INPUT: tráfico entrante, luego de haber sido ruteado y destinado al sistema local.</li>\n<li>FORWARD: tráfico entrante, luego de haber sido ruteado y destinado hacia otro host (reenviado).</li>\n<li>OUTPUT: tráfico saliente originado en el sistema local, inmediatamente luego de haber ingresado a la pila de red del kernel.</li>\n<li>POSTROUTING: tráfico saliente originado en el sistema local o reenviado, luego de haber sido ruteado y justo antes de ser puesto en el cable.</li>\n</ul>\n<h3>Comandos principales :</h3>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>-A –append → agrega una regla a una cadena.\n\n-D –delete → borra una regla de una cadena especificada.\n\n-R –replace → reemplaza una regla.\n\n-I –insert → inserta una regla en lugar de una cadena.\n\n-L –list → muestra las reglas que le pasamos como argumento.\n\n-F –flush → borra todas las reglas de una cadena.\n\n-Z –zero → pone a cero todos los contadores de una cadena.\n\n-N –new-chain → permite al usuario crear su propia cadena.\n\n-X –delete-chain → borra la cadena especificada.\n\n-P –policy → explica al kernel qué hacer con los paquetes que no coincidan con ninguna regla.\n\n-E –rename-chain → cambia el orden de una cadena.</code></pre>\n      </div>\n<h3>Condiciones Principales :</h3>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>-p –protocol → la regla se aplica a un protocolo.\n\n-s –src –source → la regla se aplica a una IP de origen.\n\n-d –dst –destination → la regla se aplica a una Ip de destino.\n\n-i –in-interface → la regla de aplica a una interfaz de origen, como eth0.\n\n-o –out-interface → la regla se aplica a una interfaz de destino.</code></pre>\n      </div>\n<h3>Condiciones Básicas TCP/UDP :</h3>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>-sport –source-port → selecciona o excluye puertos de un determinado puerto de origen.\n\n-dport –destination-port → selecciona o excluye puertos de un determinado puerto de destino.</code></pre>\n      </div>\n<p>Existen más condiciones, pero estas son las principales.</p>\n<h3>Configurar reglas por defecto :</h3>\n<p>La configuración de un firewall, es para establecer que el lo que queremos bloquear y que no.</p>\n<p>Los comandos para configurar son :</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>iptables -P INPUT DROP\n\niptables -P FORWARD DROP\n\niptables -P OUTPUT DROP</code></pre>\n      </div>\n<h3>Aplicar una regla que filtre un determinado puerto :</h3>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>iptables -A INPUT -p tcp –sport 22 22 → crea una regla para el puerto de origen tcp 2222</code></pre>\n      </div>\n<h3>Bloquear el tráfico procedente de una determinada IP :</h3>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>Bloquear por Ip:\n\n\tiptables -A INPUT -p tcp -m iprange –src-range 192.168.1.13-192.168.2.19 \n\nBloquear por Mac :\n\n\tiptables -A INPUT -m mac –mac-source 00:00:00:00:00:01</code></pre>\n      </div>\n<p>Para guardar la onfiguraciones se teclea el comando:\n<code>sudo service iptables save</code></p>\n<h3>Ver el estado del firewall :</h3>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>iptables -L -n -v</code></pre>\n      </div>\n<p>El parámetro L muestra las líneas abiertas. V permite recibir más información sobre las conexiones y N nos devuelve las direcciones IP y sus correspondientes puertos sin pasar por un servidor DNS.</p>\n<h3>Eliminar las reglas existentes :</h3>\n<p>Para borrar toda la configuración del firewall se utiliza el siguiente comando :</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>iptables -F</code></pre>\n      </div>\n<h3>Permitir conexiones entrantes :</h3>\n<p>Se utiliza el siguiente comando on sus parámetros:</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>iptables -A INPUT -i [interface] -p [protocolo] –dport [puerto] -m state –state NEW,ESTABLISHED -j ACCEPT</code></pre>\n      </div>\n<ul>\n<li>-i: debemos configurar la interfaz, ejemplo:  eth0. Esto es útil en caso de tener varias tarjetas de red</li>\n<li>-p: protocolo. Debemos especificar si el protocolo será TCP o UDP.</li>\n<li>–dport: el puerto que queremos permitir, ejemplo : 80 .</li>\n</ul>\n<h3>Permitir las conexiones salientes :</h3>\n<p>Se utiliza el siguiente comando con sus parámetros :</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>iptables -A OUTPUT -o [interfaz] -p [protocolo] –sport [puerto] -m state –state ESTABLISHED -j ACCEPT</code></pre>\n      </div>\n<ul>\n<li>-o: se debe de configurar la interfaz .</li>\n<li>-p: protocolo. Debemos especificar si el protocolo será TCP o UDP.</li>\n<li>–sport: el puerto que queremos permitir .</li>\n</ul>\n<h3>Permitir los paquetes ICMP :</h3>\n<p>Por defecto, el ping está deshabilitado. Se habilita manualmente añadiendo las correspondientes entradas en iptables.</p>\n<p>Comando :</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>Para poder hacer ping a otros servidores:\n\n\tiptables -A OUTPUT -p icmp –icmp-type echo-request -j ACCEPT\n\nPara permitir recibir solicitudes de ping de otros equipos:\n\n\tiptables -A INPUT -p icmp –icmp-type echo-reply -j ACCEPT</code></pre>\n      </div>\n<h3>Permitir que el tráfico interno salga a internet :</h3>\n<p>Se configura el firewall para que reenvíe el tráfico de la red local a través de internet.</p>\n<p>Comando :</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>iptables -A FORWARD -i eth0 -o eth1 -j ACCEPT</code></pre>\n      </div>\n<h3>Consultar los paquetes rechazados por iptables :</h3>\n<p>Para saber los paquetes que iptables ha rechazado debemos teclear:</p>\n<p>Comando :</p>\n<div class=\"gatsby-highlight\">\n      <pre class=\"language-none\"><code>iptables -N LOGGING</code></pre>\n      </div>\n<h4>Para más información:</h4>\n<!-- Please add any articles you think might be helpful to read before writing the article -->\n<ul>\n<li>\n<p>Iptables, comandos básicos:   <a href='https://www.redeszone.net/gnu-linux/iptables-configuracion-del-firewall-en-linux-con-iptables/' target='_blank' rel='nofollow'>https://www.redeszone.net/gnu-linux/iptables-configuracion-del-firewall-en-linux-con-iptables/</a></p>\n</li>\n<li>\n<p>Introducción a Iptables:   <a href='http://www.alcancelibre.org/staticpages/index.php/introduccion-iptables' target='_blank' rel='nofollow'>http://www.alcancelibre.org/staticpages/index.php/introduccion-iptables</a></p>\n</li>\n<li>\n<p>Comandos Iptables:   <a href='http://www.nexolinux.com/comandos-mas-usados-para-gestionar-iptables/\n' target='_blank' rel='nofollow'>http://www.nexolinux.com/comandos-mas-usados-para-gestionar-iptables/\n</a></p>\n</li>\n<li>\n<p>Tutorial básico de Iptables:   <a href='https://www.linuxito.com/seguridad/793-tutorial-basico-de-iptables-en-linux\n' target='_blank' rel='nofollow'>https://www.linuxito.com/seguridad/793-tutorial-basico-de-iptables-en-linux\n</a></p>\n</li>\n<li>\n<p>Red Hat Documentación Iptables :   <a href='http://web.mit.edu/rhel-doc/4/RH-DOCS/rhel-rg-es-4/s1-iptables-options.html' target='_blank' rel='nofollow'>http://web.mit.edu/rhel-doc/4/RH-DOCS/rhel-rg-es-4/s1-iptables-options.html</a></p>\n</li>\n</ul>",
            "fields": {
                "slug": "/arquitectura-sistemas-operativos-linux/20-iptables/"
            },
            "frontmatter": {
                "title": "20. Iptables"
            }
        }
    },
    "pathContext": {
        "slug": "/arquitectura-sistemas-operativos-linux/20-iptables/"
    }
}